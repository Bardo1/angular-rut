/**
 * Chilean RUT module for angular
 * @version v0.1.1 - 2013-11-29
 * @link https://github.com/angular-platanus/rut
 * @author Jaime Bunzli <jpbunzli@gmail.com>, Ignacio Baixas <ignacio@platan.us>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a){"use strict";function b(a){return a.replace(/[^0-9kK]+/g,"").toUpperCase()}function c(a,c){if(!a)return c||"";if(a=b(a),a.length<=1)return a;for(var d=a.slice(-4,-1)+"-"+a.substr(a.length-1),e=4;e<a.length;e+=3)d=a.slice(-3-e,-e)+"."+d;return d}function d(a){for(var b=parseInt(a.slice(0,-1),10),c=0,d=1;b>0;)d=(d+b%10*(9-c++%6))%11,b=Math.floor(b/10);var e=d>0?d-1+"":"K";return e===a.slice(-1)}a.module("platanus.rut",[]).filter("formatRut",function(){return c}).directive("validRut",function(){return{require:"ngModel",restrict:"AC",link:function(a,c,e,f){f.$parsers.unshift(function(a){return a=b(a),f.$setValidity("rut",""===a||d(a)),a})}}}).directive("rutInput",function(){return{template:'<input type="text" valid-rut/>',restrict:"EAC",replace:!0,link:function(a,d){d.on("blur",function(){d.val(c(d.val()))}),d.on("focus",function(){d.val(b(d.val()))})}}})}(angular);